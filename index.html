<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe - Difficulty Levels</title>

<style>
body {
  background: #0f172a;
  color: #fff;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.container {
  text-align: center;
}

h1 {
  margin-bottom: 10px;
}

.controls button, select {
  padding: 8px 14px;
  margin: 5px;
  border-radius: 5px;
  border: none;
  cursor: pointer;
}

button {
  background: #22c55e;
  color: black;
  font-weight: bold;
}

select {
  background: #1e293b;
  color: white;
}

.board {
  display: grid;
  grid-template-columns: repeat(3, 100px);
  gap: 10px;
  margin: 20px auto;
}

.cell {
  width: 100px;
  height: 100px;
  background: #1e293b;
  font-size: 40px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  border-radius: 8px;
}

.cell:hover {
  background: #334155;
}

.status {
  margin: 10px;
  font-size: 18px;
}
</style>
</head>

<body>
<div class="container">
  <h1>Tic Tac Toe</h1>

  <div class="controls">
    <button onclick="startGame('single')">Single Player</button>
    <button onclick="startGame('multi')">Multi Player</button>

    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="medium">Medium</option>
      <option value="hard">Hard</option>
    </select>
  </div>

  <div class="status" id="status">Choose mode</div>
  <div class="board" id="board"></div>

  <button onclick="resetGame()">Reset</button>
</div>

<script>
const boardDiv = document.getElementById("board");
const statusText = document.getElementById("status");

let board = Array(9).fill("");
let currentPlayer = "X";
let gameActive = false;
let mode = "";
let difficulty = "easy";

const winCombos = [
  [0,1,2],[3,4,5],[6,7,8],
  [0,3,6],[1,4,7],[2,5,8],
  [0,4,8],[2,4,6]
];

function startGame(selectedMode) {
  mode = selectedMode;
  difficulty = document.getElementById("difficulty").value;
  resetGame();
  gameActive = true;
  statusText.textContent = `Player X turn`;
}

function createBoard() {
  boardDiv.innerHTML = "";
  board.forEach((_, i) => {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.dataset.index = i;
    cell.onclick = handleMove;
    boardDiv.appendChild(cell);
  });
}

function handleMove(e) {
  const idx = e.target.dataset.index;
  if (!gameActive || board[idx]) return;

  makeMove(idx, currentPlayer);

  if (checkWin(currentPlayer)) {
    statusText.textContent = `${currentPlayer} Wins ðŸŽ‰`;
    gameActive = false;
    return;
  }

  if (isDraw()) {
    statusText.textContent = "Draw ðŸ˜";
    gameActive = false;
    return;
  }

  currentPlayer = currentPlayer === "X" ? "O" : "X";
  statusText.textContent = `Player ${currentPlayer} turn`;

  if (mode === "single" && currentPlayer === "O") {
    setTimeout(computerMove, 400);
  }
}

function makeMove(index, player) {
  board[index] = player;
  document.querySelector(`[data-index='${index}']`).textContent = player;
}

function computerMove() {
  let move;
  if (difficulty === "easy") move = randomMove();
  else if (difficulty === "medium") move = smartMove();
  else move = minimax(board, "O").index;

  makeMove(move, "O");

  if (checkWin("O")) {
    statusText.textContent = "Computer Wins ðŸ¤–";
    gameActive = false;
    return;
  }

  currentPlayer = "X";
  statusText.textContent = "Player X turn";
}

function randomMove() {
  return board.map((v,i)=>v===""?i:null).filter(v=>v!==null)
              .sort(()=>Math.random()-0.5)[0];
}

function smartMove() {
  for (let i=0;i<9;i++) {
    if (board[i]==="") {
      board[i]="O";
      if (checkWin("O")) { board[i]=""; return i; }
      board[i]="";
    }
  }
  for (let i=0;i<9;i++) {
    if (board[i]==="") {
      board[i]="X";
      if (checkWin("X")) { board[i]=""; return i; }
      board[i]="";
    }
  }
  return randomMove();
}

// ðŸ”¥ MINIMAX (Hard)
function minimax(newBoard, player) {
  const empty = newBoard.map((v,i)=>v===""?i:null).filter(v=>v!==null);

  if (checkWinner(newBoard,"X")) return {score:-10};
  if (checkWinner(newBoard,"O")) return {score:10};
  if (empty.length === 0) return {score:0};

  let moves = [];

  for (let i of empty) {
    let move = {index:i};
    newBoard[i]=player;

    let result = minimax(newBoard, player==="O"?"X":"O");
    move.score = result.score;

    newBoard[i]="";
    moves.push(move);
  }

  let best;
  if (player==="O") {
    let max = -Infinity;
    moves.forEach(m=>{ if(m.score>max){max=m.score;best=m;}});
  } else {
    let min = Infinity;
    moves.forEach(m=>{ if(m.score<min){min=m.score;best=m;}});
  }
  return best;
}

function checkWin(player) {
  return winCombos.some(c => c.every(i => board[i]===player));
}

function checkWinner(b, p) {
  return winCombos.some(c => c.every(i => b[i]===p));
}

function isDraw() {
  return board.every(cell => cell !== "");
}

function resetGame() {
  board = Array(9).fill("");
  currentPlayer = "X";
  gameActive = mode !== "";
  statusText.textContent = mode ? "Player X turn" : "Choose mode";
  createBoard();
}

createBoard();
</script>
</body>
</html>
